{"$schema":"http://json-schema.org/draft-07/schema#","additionalProperties":false,"definitions":{"ACLLogConfig":{"additionalProperties":false,"properties":{"keep":{"$ref":"#/definitions/RetentionPolicy","default":"30 days","description":"Retention policy"},"log_allowed":{"default":false,"description":"Whether log allowed IPs","type":"boolean"},"path":{"$ref":"#/definitions/URI","description":"The path to the access log file."},"rotate":{"$ref":"#/definitions/Duration","default":"1 day","description":"Rotation interval"},"stdout":{"default":false,"description":"Log to stdout","type":"boolean"}},"type":"object"},"ACLMatcher":{"anyOf":[{"pattern":"^$","type":"string"},{"pattern":"^$","type":"string"},{"pattern":"^cidr:[0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*$","type":"string"},{"pattern":"^cidr:.*:.*:.*:.*:.*:.*:.*:.*$","type":"string"},{"pattern":"^cidr:[0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*/[0-9]*$","type":"string"},{"pattern":"^cidr:::[0-9]*$","type":"string"},{"pattern":"^cidr:.*::/[0-9]*$","type":"string"},{"pattern":"^cidr:.*:.*::/[0-9]*$","type":"string"},{"pattern":"^country:.*$","type":"string"},{"pattern":"^tz:.*/.*$","type":"string"}]},"Duration":{"pattern":"^([0-9]+(ms|s|m|h))+$","type":"string"},"RetentionPolicy":{"anyOf":[{"pattern":"^[0-9]* days$","type":"string"},{"pattern":"^[0-9]* weeks$","type":"string"},{"pattern":"^[0-9]* months$","type":"string"},{"pattern":"^last [0-9]*$","type":"string"},{"pattern":"^[0-9]* KB$","type":"string"},{"pattern":"^[0-9]* MB$","type":"string"},{"pattern":"^[0-9]* GB$","type":"string"},{"pattern":"^[0-9]* kb$","type":"string"},{"pattern":"^[0-9]* mb$","type":"string"},{"pattern":"^[0-9]* gb$","type":"string"}]},"URI":{"format":"uri-reference","type":"string"}},"properties":{"allow":{"description":"Allow list","items":{"$ref":"#/definitions/ACLMatcher"},"type":"array"},"allow_local":{"default":true,"description":"Allow local addresses","type":"boolean"},"default":{"default":"allow","description":"Default action","enum":["allow","deny"],"type":"string"},"deny":{"description":"Deny list","items":{"$ref":"#/definitions/ACLMatcher"},"type":"array"},"log":{"$ref":"#/definitions/ACLLogConfig","description":"ACL logger"},"maxmind":{"additionalProperties":false,"description":"Maxmind credentials","properties":{"account_id":{"anyOf":[{"pattern":"^[0-9]*$","type":"string"},{"type":"number"}],"description":"Account ID"},"database":{"description":"Database","enum":["geoip2","geolite"],"type":"string"},"license_key":{"description":"License key","type":"string"}},"required":["account_id","database","license_key"],"type":"object"}},"type":"object"}